<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="One is never served so well as by oneself. Charles-Guillaume Étienne In this short tutorial we will create a custom UI control view, make it easily designable with storyboard and auto-layout compatibl">
<meta name="keywords" content="ios,xcode,storyboard,swift,ibdesignable">
<meta property="og:type" content="article">
<meta property="og:title" content="How to create custom storyboard-friendly UIView without XIB">
<meta property="og:url" content="http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/index.html">
<meta property="og:site_name" content="Roman Filippov&#39;s personal website">
<meta property="og:description" content="One is never served so well as by oneself. Charles-Guillaume Étienne In this short tutorial we will create a custom UI control view, make it easily designable with storyboard and auto-layout compatibl">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://filippov.tk/images/xib_header.png">
<meta property="og:image" content="https://koenig-media.raywenderlich.com/uploads/2014/12/1-FloUnitCircle.png">
<meta property="og:image" content="http://filippov.tk/images/ib_1.png">
<meta property="og:image" content="http://filippov.tk/images/ib_2.png">
<meta property="og:image" content="http://filippov.tk/images/ib_3.png">
<meta property="og:updated_time" content="2017-09-26T23:00:54.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How to create custom storyboard-friendly UIView without XIB">
<meta name="twitter:description" content="One is never served so well as by oneself. Charles-Guillaume Étienne In this short tutorial we will create a custom UI control view, make it easily designable with storyboard and auto-layout compatibl">
<meta name="twitter:image" content="http://filippov.tk/images/xib_header.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>How to create custom storyboard-friendly UIView without XIB</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/cv/">CV</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/filiroman">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2017/09/28/How-to-make-self-resizing-table-view-cells/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&text=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&title=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&is_video=false&description=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=How to create custom storyboard-friendly UIView without XIB&body=Check out this article: http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&title=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&title=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&title=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&title=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&name=How to create custom storyboard-friendly UIView without XIB&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Creating-a-project"><span class="toc-number">1.</span> <span class="toc-text">Creating a project</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Initializers-and-constraints"><span class="toc-number">2.</span> <span class="toc-text">Initializers and constraints</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Draw-our-view"><span class="toc-number">3.</span> <span class="toc-text">Draw our view</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        How to create custom storyboard-friendly UIView without XIB
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Roman Filippov's personal website</span>
      </span>
      
    <div class="postdate">
        <time datetime="2017-09-22T21:00:07.000Z" itemprop="datePublished">23-09-2017</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/ibdesignable/">ibdesignable</a>, <a class="tag-link" href="/tags/ios/">ios</a>, <a class="tag-link" href="/tags/storyboard/">storyboard</a>, <a class="tag-link" href="/tags/swift/">swift</a>, <a class="tag-link" href="/tags/xcode/">xcode</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <blockquote><p>One is never served so well as by oneself.</p>
<footer><strong>Charles-Guillaume Étienne</strong></footer></blockquote>
<p>In this short tutorial we will create a custom UI control view, make it easily designable with storyboard and auto-layout compatible. With no doubt you can design and create your views using XIB files or directly on storyboards, but in complex applications views can be complicated too. They can be dynamically loaded, depending on the events or just hard-coded using some other 3rd party view classes that aren’t storyboard-friendly. Anyway you will see that the process itself is very easy and understandable, so let’s get started!</p>
<h2 id="Creating-a-project"><a href="#Creating-a-project" class="headerlink" title="Creating a project"></a>Creating a project</h2><p>Open Xcode and create a new single-view application. In this tutorial I’ll use Swift 4, but it’s of course possible to make everything using earlier versions of Swift (with a slightly different syntax) or even Objective-C.</p>
<p>Once created, the app contains a default view controller and a storyboard.<br><img src="/images/xib_header.png" alt="&quot;Result of the tutorial&quot;"><br>In this tutorial we will create a circle UI element that usually helps to depict some stored value in settings section of your app (could be anything else, it’s up to your imagination!). So first we create a new Swift file with a UIView subclass definition inside. Since we don’t need name prefixes anymore, we simply call that class CircleView. Let’s start by adding several variables and properties, please see the code listing below.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@IBDesignable</span> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CircleView</span>: <span class="title">UIView</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> circleLabel: <span class="type">UILabel</span>!</div><div class="line">  <span class="meta">@IBInspectable</span> <span class="keyword">public</span> <span class="keyword">var</span> outlineColor: <span class="type">UIColor</span> = <span class="type">UIColor</span>.orange</div><div class="line">  <span class="meta">@IBInspectable</span> <span class="keyword">public</span> <span class="keyword">var</span> counterColor: <span class="type">UIColor</span> = <span class="type">UIColor</span>.orange</div><div class="line">  <span class="meta">@IBInspectable</span> <span class="keyword">public</span> <span class="keyword">var</span> minValue: <span class="type">Int</span> = <span class="number">0</span></div><div class="line">  <span class="meta">@IBInspectable</span> <span class="keyword">public</span> <span class="keyword">var</span> maxValue: <span class="type">Int</span> = <span class="number">8</span></div><div class="line">  <span class="meta">@IBInspectable</span> <span class="keyword">public</span> <span class="keyword">var</span> lineWidth: <span class="type">CGFloat</span> = <span class="number">4.0</span></div><div class="line">  <span class="meta">@IBInspectable</span> <span class="keyword">public</span> <span class="keyword">var</span> arcWidth: <span class="type">CGFloat</span> = <span class="number">80.0</span></div><div class="line">  <span class="meta">@IBInspectable</span> <span class="keyword">public</span> <span class="keyword">var</span> arcAngle: <span class="type">Int</span> = <span class="number">360</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Here we declare the basic parameters of our view - outline and counter colors, min and max values of our counter, also the line width of our outline, the width of the arc and the general arc angle in degrees (this is the angle when our counter reaches its maximum). All properties are declared as public so that we should be able to change them from the outside of the class, except the label, which is intended only for showing the counter, so we hide it’s implementation. Note the @IBDesignable keyword before the class definition. It tells xcode that the class should be rendered in IB. We also use @IBInspectable keyword to show that these properties should be Interface Builder compatible so we could change them from our storyboard file without writing any code. We’ll soon come to that. At the next step we add the counter property and some util methods to the class definition.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _counter: <span class="type">Int</span> = <span class="number">0</span> &#123;</div><div class="line">  <span class="keyword">didSet</span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">guard</span> _counter &gt;= minValue <span class="keyword">else</span> &#123;</div><div class="line">      _counter = minValue</div><div class="line">      <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">guard</span> _counter &lt;= maxValue <span class="keyword">else</span> &#123;</div><div class="line">      _counter = maxValue</div><div class="line">      <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    circleLabel.text = <span class="type">String</span>(_counter)</div><div class="line">    setNeedsDisplay()</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@IBInspectable</span> <span class="keyword">public</span> <span class="keyword">var</span> counter: <span class="type">Int</span> &#123;</div><div class="line">  <span class="keyword">get</span> &#123;</div><div class="line">    <span class="keyword">return</span> _counter</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">set</span> (aNewValue) &#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> aNewValue != _counter &#123;</div><div class="line">      _counter = aNewValue</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> radius: <span class="type">CGFloat</span> &#123;</div><div class="line">  <span class="keyword">get</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(bounds.width, bounds.height)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> valuesCount: <span class="type">Int</span> &#123;</div><div class="line">  <span class="keyword">get</span> &#123;</div><div class="line">    <span class="keyword">return</span> maxValue-minValue+<span class="number">1</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Here we use internal variable _counter to keep track of the current value and invoke setNeedsDisplay() when the value is changed. This is needed because - as we will see later, we need to redraw our view every time its value changes. By invoking setNeedsDisplay() we set up a flag that tells the system that this view needs to be redrawn. The counter property is a bit tricky. When we change counter value we write something like circleView.counter += 1 and the setter is being called. It checks if old and new values are different and then changes internal _counter variable. When it is changed, the didSet method is called. It checks the constraints using guard keyword, sets the label value and finally invokes setNeedsDisplay() to redraw the view.<br>Next we add initializers and helper methods.</p>
<h2 id="Initializers-and-constraints"><a href="#Initializers-and-constraints" class="headerlink" title="Initializers and constraints"></a>Initializers and constraints</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</div><div class="line">  <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</div><div class="line"></div><div class="line">  createLabel()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">required</span> <span class="keyword">public</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</div><div class="line">  <span class="keyword">super</span>.<span class="keyword">init</span>(coder: aDecoder)</div><div class="line"></div><div class="line">  createLabel()</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">createLabel</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">  circleLabel = <span class="type">UILabel</span>(frame: <span class="type">CGRect</span>.zero)</div><div class="line">  circleLabel.text = <span class="string">"0"</span></div><div class="line">  circleLabel.font = <span class="type">UIFont</span>.systemFont(ofSize: <span class="number">36</span>)</div><div class="line">  circleLabel.textAlignment = .center</div><div class="line">  circleLabel.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></div><div class="line">  <span class="keyword">self</span>.addSubview(circleLabel)</div><div class="line"></div><div class="line">  updateConstraints()</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">override</span> <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">updateConstraints</span><span class="params">()</span></span> &#123;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> shouldUpdateContraints &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> xCenter = <span class="type">NSLayoutConstraint</span>(item: circleLabel, attribute: .centerX, relatedBy: .<span class="built_in">equal</span>, toItem: <span class="keyword">self</span>, attribute: .centerX, multiplier: <span class="number">1</span>, constant: <span class="number">0</span>)</div><div class="line">    <span class="keyword">let</span> yCenter = <span class="type">NSLayoutConstraint</span>(item: circleLabel, attribute: .centerY, relatedBy: .<span class="built_in">equal</span>, toItem: <span class="keyword">self</span>, attribute: .centerY, multiplier: <span class="number">1</span>, constant: <span class="number">0</span>)</div><div class="line">    <span class="type">NSLayoutConstraint</span>.activate([xCenter, yCenter])</div><div class="line"></div><div class="line">    shouldUpdateContraints = <span class="literal">false</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">super</span>.updateConstraints()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Since we are subclassing UIView we have to override the both initializers since we don’t know which one can be executed. There we simply create a label, set up some properties and add it to the view. Important here is the updateConstraints() function, which is called by auto-layout engine during view construction process. It’s enough to set up constraints once so we add new internal variable to our class definition:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> shouldUpdateContraints: <span class="type">Bool</span> = <span class="literal">true</span></div></pre></td></tr></table></figure>
<p>Remember that we must always call updateConstraints() function from our parent class in the end.</p>
<h2 id="Draw-our-view"><a href="#Draw-our-view" class="headerlink" title="Draw our view"></a>Draw our view</h2><p>Last, but not least, we override the draw function. It is called every time the view needs to be rendered on the screen. You should NEVER call it manually, because it’s being called automatically by the system during screen update cycle. If you need to redraw some of your views, just call setNeedsDisplay() function on it and it will be redrawn on the next update cycle.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">draw</span><span class="params">(<span class="number">_</span> rect: CGRect)</span></span> &#123;</div><div class="line">  <span class="comment">//1</span></div><div class="line">  <span class="keyword">guard</span> lineWidth&gt;<span class="number">0</span> <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">guard</span> maxValue&gt;minValue <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">guard</span> arcWidth&gt;<span class="number">0</span> &amp;&amp; arcAngle&gt;<span class="number">0</span> <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">guard</span> (minValue...maxValue) ~= counter <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">//2</span></div><div class="line">  <span class="keyword">let</span> center = <span class="type">CGPoint</span>(x: bounds.width / <span class="number">2</span>, y: bounds.height / <span class="number">2</span>)</div><div class="line">  <span class="keyword">let</span> arcAngleRadians = <span class="type">CGFloat</span>(arcAngle.degreesToRadians)</div><div class="line">  <span class="keyword">let</span> startAngle: <span class="type">CGFloat</span> = <span class="number">3</span> * .pi/<span class="number">2</span> - arcAngleRadians/<span class="number">2</span></div><div class="line">  <span class="keyword">let</span> endAngle: <span class="type">CGFloat</span> = <span class="number">3</span> * .pi/<span class="number">2</span> + arcAngleRadians/<span class="number">2</span></div><div class="line"></div><div class="line">  <span class="comment">// 3</span></div><div class="line">  <span class="keyword">let</span> outlinePath = <span class="type">UIBezierPath</span>(arcCenter: center,</div><div class="line">                                 radius: (bounds.width - lineWidth)/<span class="number">2</span>,</div><div class="line">                                 startAngle: startAngle,</div><div class="line">                                 endAngle: endAngle,</div><div class="line">                                 clockwise: <span class="literal">true</span>)</div><div class="line">  outlinePath.addArc(withCenter: center,</div><div class="line">                     radius: bounds.width/<span class="number">2</span> - arcWidth + lineWidth/<span class="number">2</span>,</div><div class="line">                     startAngle: endAngle,</div><div class="line">                     endAngle: startAngle,</div><div class="line">                     clockwise: <span class="literal">false</span>)</div><div class="line"></div><div class="line">  outlinePath.close()</div><div class="line">  outlineColor.setStroke()</div><div class="line">  outlinePath.lineWidth = lineWidth</div><div class="line">  outlinePath.stroke()    </div><div class="line"></div><div class="line">  <span class="comment">// 4</span></div><div class="line">  <span class="keyword">let</span> arcLengthPerValue = arcAngleRadians / <span class="type">CGFloat</span>(maxValue - minValue)</div><div class="line">  <span class="keyword">let</span> outlineEndAngle = arcLengthPerValue * <span class="type">CGFloat</span>(counter - minValue) + startAngle</div><div class="line"></div><div class="line">  <span class="keyword">let</span> path = <span class="type">UIBezierPath</span>(arcCenter: center,</div><div class="line">                          radius: radius/<span class="number">2</span> - arcWidth/<span class="number">2</span>,</div><div class="line">                          startAngle: startAngle,</div><div class="line">                          endAngle: outlineEndAngle,</div><div class="line">                          clockwise: <span class="literal">true</span>)</div><div class="line"></div><div class="line">  path.lineWidth = arcWidth</div><div class="line">  counterColor.setStroke()</div><div class="line">  path.stroke()</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This is our main function, where all basic work for our view is done so let’s quickly go through the steps.<br>I found the perfect image on raywendelich.com web-site so it can help you to understand the maths behind these calculations.</p>
<p><img src="https://koenig-media.raywenderlich.com/uploads/2014/12/1-FloUnitCircle.png" alt="&quot;Unit circle&quot;"></p>
<ol>
<li>Check if view variables are set correctly, otherwise don’t draw anything.</li>
<li>Calculate basic variables. Here we get our center point (we need it since we’re drawing a circle), convert arcAngle to radians because Core Graphics module is using radians. We also calculate start and end angle, which is arc “length” dependent.<br>Since our arc “center” is potentially located at 3*pi/2 point (image if someone set 180 degrees for arcAngle). So to find start angle we need to substract a half of our arcLength from the center and add it to find the end. Pretty simple, huh?</li>
<li>Here we draw the basic outline across all the view using Core Graphics and UIBezierPath object. First we specify outer line, then add the inner one, close the shape and draw it.</li>
<li>Here we draw the “counter” arc. First we need to calculate end angle, depending on the counter value. First we calculate how many “degrees” (actually in radians, but it’s easier to understand) each counter value consists of, then we just multiply it to the value itself and add start angle.</li>
</ol>
<p>Here we go, our view is ready for test, so let add it to the storyboard! Open Main.storyboard file with Interface builder and add new UIView object and two buttons to the scene. Next, add these variables and method to ViewController.swift :</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//add to ViewController class</span></div><div class="line"><span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> circleView: <span class="type">CircleView</span>!</div><div class="line"><span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> plusButton: <span class="type">UIButton</span>!</div><div class="line"><span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> minusButton: <span class="type">UIButton</span>!</div><div class="line"></div><div class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">buttonPressed</span><span class="params">(<span class="number">_</span> sender: UIButton)</span></span> &#123;</div><div class="line">  <span class="keyword">if</span> sender == plusButton &#123;</div><div class="line">    circleView.counter += <span class="number">1</span></div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    circleView.counter -= <span class="number">1</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>No go back to the storyboard, and add referencing outlets for buttons and circleView. Then add buttonPressed selector for both buttons (you can do this by right-clicking on the button/view and then touch and drag your pointer from “+” sign to the ViewController in Scene tree on the left side of IB window). Here is the result for plus button:</p>
<p><img src="/images/ib_1.png" alt="&quot;Result for IB 1&quot;"></p>
<p>Then add constraints for the buttons to be placed according to the screenshot above and for the circleView as follows:</p>
<p><img src="/images/ib_2.png" alt="&quot;Result for IB 1&quot;"></p>
<p>Last step is to specify CircleView class for our UIView object. Write it on the Identity Inspector tab. After you’ve done it, xcode will compile your view class and draw it. Now you can change all your attributes on Attributed Inspector tab and you will see the changes immediately, even without running an app. Whoa!!</p>
<p><img src="/images/ib_3.png" alt="&quot;Result for IB 1&quot;"></p>
<p>Now you can set up initial values using IB and run your app to see if everything works fine. Congratulations! You’ve just created your first custom UI Element that is IB compatible and designable plus uses auto-layout to stretch itself into different screens. In the next tutorial we’ll add gesture recognizers to our view to make value changing more intuitive :)</p>
<p>By the way, I’ve recently pushed my RFCircleView into the CocoaPods repository. If you don’t know what CocoaPods is, go to the <a href="https://cocoapods.org/" target="_blank" rel="external">https://cocoapods.org/</a> right now and check it out - this is an amazing tool with a huge library of community-developed plugins to do almost anything on iOS. <a href="https://cocoapods.org/pods/RFCircleView" target="_blank" rel="external">Here is the link</a> to my view repository. So that’s all for today, I hope that the article was helpful!</p>
<p>Cheers,<br>Roman Filippov.</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/cv/">CV</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/filiroman">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Creating-a-project"><span class="toc-number">1.</span> <span class="toc-text">Creating a project</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Initializers-and-constraints"><span class="toc-number">2.</span> <span class="toc-text">Initializers and constraints</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Draw-our-view"><span class="toc-number">3.</span> <span class="toc-text">Draw our view</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&text=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&title=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&is_video=false&description=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=How to create custom storyboard-friendly UIView without XIB&body=Check out this article: http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&title=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&title=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&title=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&title=How to create custom storyboard-friendly UIView without XIB"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://filippov.tk/2017/09/23/How-to-create-custom-Storyboard-frendly-UIView-without-XIB/&name=How to create custom storyboard-friendly UIView without XIB&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Roman Filippov
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/cv/">CV</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="https://github.com/filiroman">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'filippov-tk';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


